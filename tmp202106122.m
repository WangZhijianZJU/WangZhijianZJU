
% D:\MATLAB\R2016a\bin\tmp202106122.m


function [T,Y] = tmp202106122()
Yr=[];
noise_Amp =0.001
        for i=1:100
            [T,Y] = tmp202106122_em(noise_Amp);
            [ Yret3,mn,am_eigencycleDim_t] = from_N_colExp_out_am(Y,mean(Y));
            Yr=[Yr  Yret3];
        end
end



function [T,Y] = tmp202106122_em(noise_Amp)

tspan = [0 5];  
initial_pos = [2 1 1 1 2 1 1 1 ]/5 + noise_Amp * rand(1,8);
initial_pos = [initial_pos(1:4)/sum(initial_pos(1:4)) initial_pos(5:8)/sum(initial_pos(5:8)) ];

% % for c=1:3; b=[0.25 1 4]; a=b(c);
% [T,Y] = ode15s(@osc,tspan,initial_pos);
% [T,Y] = ode23(@osc,tspan,initial_pos);
%   [T,Y] = ode113(@osc,tspan,initial_pos); 
  [T,Y] = ode45(@osc,tspan,initial_pos); 
%         figure;plotmatrix(Y,'.-');
        
        function dydt = osc(t,y) 
            dydt = ... 
           [  y(1)*(5*y(5) - 5*y(6) - 5*y(7) - 5*y(8) + y(1)*(5*y(6) - 5*y(5) + 5*y(7) + 5*y(8)) + y(2)*(5*y(5) + 5*y(6) - 5*y(7) - 5*y(8)) + y(3)*(5*y(5) - 5*y(6) + 5*y(7) - 5*y(8)) + y(4)*(5*y(5) - 5*y(6) - 5*y(7) + 5*y(8)))
              y(2)*(5*y(7) - 5*y(6) - 5*y(5) + 5*y(8) + y(1)*(5*y(6) - 5*y(5) + 5*y(7) + 5*y(8)) + y(2)*(5*y(5) + 5*y(6) - 5*y(7) - 5*y(8)) + y(3)*(5*y(5) - 5*y(6) + 5*y(7) - 5*y(8)) + y(4)*(5*y(5) - 5*y(6) - 5*y(7) + 5*y(8)))
              y(3)*(5*y(6) - 5*y(5) - 5*y(7) + 5*y(8) + y(1)*(5*y(6) - 5*y(5) + 5*y(7) + 5*y(8)) + y(2)*(5*y(5) + 5*y(6) - 5*y(7) - 5*y(8)) + y(3)*(5*y(5) - 5*y(6) + 5*y(7) - 5*y(8)) + y(4)*(5*y(5) - 5*y(6) - 5*y(7) + 5*y(8)))
              y(4)*(5*y(6) - 5*y(5) + 5*y(7) - 5*y(8) + y(1)*(5*y(6) - 5*y(5) + 5*y(7) + 5*y(8)) + y(2)*(5*y(5) + 5*y(6) - 5*y(7) - 5*y(8)) + y(3)*(5*y(5) - 5*y(6) + 5*y(7) - 5*y(8)) + y(4)*(5*y(5) - 5*y(6) - 5*y(7) + 5*y(8)))
             -y(5)*(5*y(1) - 5*y(2) - 5*y(3) - 5*y(4) + y(5)*(5*y(2) - 5*y(1) + 5*y(3) + 5*y(4)) + y(6)*(5*y(1) + 5*y(2) - 5*y(3) - 5*y(4)) + y(7)*(5*y(1) - 5*y(2) + 5*y(3) - 5*y(4)) + y(8)*(5*y(1) - 5*y(2) - 5*y(3) + 5*y(4)))
             -y(6)*(5*y(3) - 5*y(2) - 5*y(1) + 5*y(4) + y(5)*(5*y(2) - 5*y(1) + 5*y(3) + 5*y(4)) + y(6)*(5*y(1) + 5*y(2) - 5*y(3) - 5*y(4)) + y(7)*(5*y(1) - 5*y(2) + 5*y(3) - 5*y(4)) + y(8)*(5*y(1) - 5*y(2) - 5*y(3) + 5*y(4)))
             -y(7)*(5*y(2) - 5*y(1) - 5*y(3) + 5*y(4) + y(5)*(5*y(2) - 5*y(1) + 5*y(3) + 5*y(4)) + y(6)*(5*y(1) + 5*y(2) - 5*y(3) - 5*y(4)) + y(7)*(5*y(1) - 5*y(2) + 5*y(3) - 5*y(4)) + y(8)*(5*y(1) - 5*y(2) - 5*y(3) + 5*y(4)))
             -y(8)*(5*y(2) - 5*y(1) + 5*y(3) - 5*y(4) + y(5)*(5*y(2) - 5*y(1) + 5*y(3) + 5*y(4)) + y(6)*(5*y(1) + 5*y(2) - 5*y(3) - 5*y(4)) + y(7)*(5*y(1) - 5*y(2) + 5*y(3) - 5*y(4)) + y(8)*(5*y(1) - 5*y(2) - 5*y(3) + 5*y(4)))
             ];
         
    %            %Qinmei_5%
    %         dydt = ... 
    %         [ -y(1)*(y(3)*(2*y(1) + 5*y(2) + 9*y(4) + 12*y(5)) - 4*y(3) - 11*y(4) - 11*y(5) - 3*y(2) + y(1)*(3*y(2) + 4*y(3) + 11*y(4) + 11*y(5)) + y(4)*(6*y(1) + 10*y(2) + 10*y(3) + 3*y(5)) + y(2)*(5*y(1) + 2*y(3) + 11*y(4) + 12*y(5)) + y(5)*(10*y(1) + 10*y(2) + 10*y(3) + 4*y(4)))
    %           -y(2)*(y(3)*(2*y(1) + 5*y(2) + 9*y(4) + 12*y(5)) - 2*y(3) - 11*y(4) - 12*y(5) - 5*y(1) + y(1)*(3*y(2) + 4*y(3) + 11*y(4) + 11*y(5)) + y(4)*(6*y(1) + 10*y(2) + 10*y(3) + 3*y(5)) + y(2)*(5*y(1) + 2*y(3) + 11*y(4) + 12*y(5)) + y(5)*(10*y(1) + 10*y(2) + 10*y(3) + 4*y(4)))
    %           -y(3)*(y(3)*(2*y(1) + 5*y(2) + 9*y(4) + 12*y(5)) - 5*y(2) - 9*y(4) - 12*y(5) - 2*y(1) + y(1)*(3*y(2) + 4*y(3) + 11*y(4) + 11*y(5)) + y(4)*(6*y(1) + 10*y(2) + 10*y(3) + 3*y(5)) + y(2)*(5*y(1) + 2*y(3) + 11*y(4) + 12*y(5)) + y(5)*(10*y(1) + 10*y(2) + 10*y(3) + 4*y(4)))
    %           -y(4)*(y(3)*(2*y(1) + 5*y(2) + 9*y(4) + 12*y(5)) - 10*y(2) - 10*y(3) - 3*y(5) - 6*y(1) + y(1)*(3*y(2) + 4*y(3) + 11*y(4) + 11*y(5)) + y(4)*(6*y(1) + 10*y(2) + 10*y(3) + 3*y(5)) + y(2)*(5*y(1) + 2*y(3) + 11*y(4) + 12*y(5)) + y(5)*(10*y(1) + 10*y(2) + 10*y(3) + 4*y(4)))
    %           -y(5)*(y(3)*(2*y(1) + 5*y(2) + 9*y(4) + 12*y(5)) - 10*y(2) - 10*y(3) - 4*y(4) - 10*y(1) + y(1)*(3*y(2) + 4*y(3) + 11*y(4) + 11*y(5)) + y(4)*(6*y(1) + 10*y(2) + 10*y(3) + 3*y(5)) + y(2)*(5*y(1) + 2*y(3) + 11*y(4) + 12*y(5)) + y(5)*(10*y(1) + 10*y(2) + 10*y(3) + 4*y(4)))
    %         ]; 
    
    %           %Shujie_4% global a ; for c=1:3; b=[0.25 1 4]; a=b(c);
    %         dydt = [ -(y(1)*(y(1)*y(2) - a*y(4) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4)))/(y(1)*y(2) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4))
    %                  -(y(2)*(y(1)*y(2) - y(1) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4)))/(y(1)*y(2) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4))
    %                  -(y(3)*(y(1)*y(2) - y(2) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4)))/(y(1)*y(2) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4))
    %                  -(y(4)*(y(1)*y(2) - y(3) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4)))/(y(1)*y(2) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4))];
    %   
        end
end






function [T,Y] = tmp202106122_old() 
global a
rr=[];
tspan = [0 30]; 
initial_pos = [0.1 0.3 0.4 0.2 0.03 0.02 0.02 0.03];
initial_pos = [2 1 1 1 2 1 1 1 ]/5 + 0.001*rand(1,8);
initial_pos = [initial_pos(1:4)/sum(initial_pos(1:4)) initial_pos(5:8)/sum(initial_pos(5:8)) ];

% % for c=1:3;
% %     b=[0.25 1 4];
% %     a=b(c);
% [T,Y] = ode15s(@osc,tspan,initial_pos);
% [T,Y] = ode23(@osc,tspan,initial_pos);
[T,Y] = ode45(@osc,tspan,initial_pos);
%         plot(T,Y(:,1),'.-')
        figure;plotmatrix(Y); title(num2str(a))
%     rr = [rr; Y T ones(size(T,1),1)*a]; 
% end
        function dydt = osc(t,y) 
            dydt = ... 
            [  y(1)*(5*y(5) - 5*y(6) - 5*y(7) - 5*y(8) + y(1)*(5*y(6) - 5*y(5) + 5*y(7) + 5*y(8)) + y(2)*(5*y(5) + 5*y(6) - 5*y(7) - 5*y(8)) + y(3)*(5*y(5) - 5*y(6) + 5*y(7) - 5*y(8)) + y(4)*(5*y(5) - 5*y(6) - 5*y(7) + 5*y(8)))
              y(2)*(5*y(7) - 5*y(6) - 5*y(5) + 5*y(8) + y(1)*(5*y(6) - 5*y(5) + 5*y(7) + 5*y(8)) + y(2)*(5*y(5) + 5*y(6) - 5*y(7) - 5*y(8)) + y(3)*(5*y(5) - 5*y(6) + 5*y(7) - 5*y(8)) + y(4)*(5*y(5) - 5*y(6) - 5*y(7) + 5*y(8)))
              y(3)*(5*y(6) - 5*y(5) - 5*y(7) + 5*y(8) + y(1)*(5*y(6) - 5*y(5) + 5*y(7) + 5*y(8)) + y(2)*(5*y(5) + 5*y(6) - 5*y(7) - 5*y(8)) + y(3)*(5*y(5) - 5*y(6) + 5*y(7) - 5*y(8)) + y(4)*(5*y(5) - 5*y(6) - 5*y(7) + 5*y(8)))
              y(4)*(5*y(6) - 5*y(5) + 5*y(7) - 5*y(8) + y(1)*(5*y(6) - 5*y(5) + 5*y(7) + 5*y(8)) + y(2)*(5*y(5) + 5*y(6) - 5*y(7) - 5*y(8)) + y(3)*(5*y(5) - 5*y(6) + 5*y(7) - 5*y(8)) + y(4)*(5*y(5) - 5*y(6) - 5*y(7) + 5*y(8)))
             -y(5)*(5*y(1) - 5*y(2) - 5*y(3) - 5*y(4) + y(5)*(5*y(2) - 5*y(1) + 5*y(3) + 5*y(4)) + y(6)*(5*y(1) + 5*y(2) - 5*y(3) - 5*y(4)) + y(7)*(5*y(1) - 5*y(2) + 5*y(3) - 5*y(4)) + y(8)*(5*y(1) - 5*y(2) - 5*y(3) + 5*y(4)))
             -y(6)*(5*y(3) - 5*y(2) - 5*y(1) + 5*y(4) + y(5)*(5*y(2) - 5*y(1) + 5*y(3) + 5*y(4)) + y(6)*(5*y(1) + 5*y(2) - 5*y(3) - 5*y(4)) + y(7)*(5*y(1) - 5*y(2) + 5*y(3) - 5*y(4)) + y(8)*(5*y(1) - 5*y(2) - 5*y(3) + 5*y(4)))
             -y(7)*(5*y(2) - 5*y(1) - 5*y(3) + 5*y(4) + y(5)*(5*y(2) - 5*y(1) + 5*y(3) + 5*y(4)) + y(6)*(5*y(1) + 5*y(2) - 5*y(3) - 5*y(4)) + y(7)*(5*y(1) - 5*y(2) + 5*y(3) - 5*y(4)) + y(8)*(5*y(1) - 5*y(2) - 5*y(3) + 5*y(4)))
             -y(8)*(5*y(2) - 5*y(1) + 5*y(3) - 5*y(4) + y(5)*(5*y(2) - 5*y(1) + 5*y(3) + 5*y(4)) + y(6)*(5*y(1) + 5*y(2) - 5*y(3) - 5*y(4)) + y(7)*(5*y(1) - 5*y(2) + 5*y(3) - 5*y(4)) + y(8)*(5*y(1) - 5*y(2) - 5*y(3) + 5*y(4)))
             ];
    %         dydt = ... 
    %         [ -y(1)*(y(3)*(2*y(1) + 5*y(2) + 9*y(4) + 12*y(5)) - 4*y(3) - 11*y(4) - 11*y(5) - 3*y(2) + y(1)*(3*y(2) + 4*y(3) + 11*y(4) + 11*y(5)) + y(4)*(6*y(1) + 10*y(2) + 10*y(3) + 3*y(5)) + y(2)*(5*y(1) + 2*y(3) + 11*y(4) + 12*y(5)) + y(5)*(10*y(1) + 10*y(2) + 10*y(3) + 4*y(4)))
    %           -y(2)*(y(3)*(2*y(1) + 5*y(2) + 9*y(4) + 12*y(5)) - 2*y(3) - 11*y(4) - 12*y(5) - 5*y(1) + y(1)*(3*y(2) + 4*y(3) + 11*y(4) + 11*y(5)) + y(4)*(6*y(1) + 10*y(2) + 10*y(3) + 3*y(5)) + y(2)*(5*y(1) + 2*y(3) + 11*y(4) + 12*y(5)) + y(5)*(10*y(1) + 10*y(2) + 10*y(3) + 4*y(4)))
    %           -y(3)*(y(3)*(2*y(1) + 5*y(2) + 9*y(4) + 12*y(5)) - 5*y(2) - 9*y(4) - 12*y(5) - 2*y(1) + y(1)*(3*y(2) + 4*y(3) + 11*y(4) + 11*y(5)) + y(4)*(6*y(1) + 10*y(2) + 10*y(3) + 3*y(5)) + y(2)*(5*y(1) + 2*y(3) + 11*y(4) + 12*y(5)) + y(5)*(10*y(1) + 10*y(2) + 10*y(3) + 4*y(4)))
    %           -y(4)*(y(3)*(2*y(1) + 5*y(2) + 9*y(4) + 12*y(5)) - 10*y(2) - 10*y(3) - 3*y(5) - 6*y(1) + y(1)*(3*y(2) + 4*y(3) + 11*y(4) + 11*y(5)) + y(4)*(6*y(1) + 10*y(2) + 10*y(3) + 3*y(5)) + y(2)*(5*y(1) + 2*y(3) + 11*y(4) + 12*y(5)) + y(5)*(10*y(1) + 10*y(2) + 10*y(3) + 4*y(4)))
    %           -y(5)*(y(3)*(2*y(1) + 5*y(2) + 9*y(4) + 12*y(5)) - 10*y(2) - 10*y(3) - 4*y(4) - 10*y(1) + y(1)*(3*y(2) + 4*y(3) + 11*y(4) + 11*y(5)) + y(4)*(6*y(1) + 10*y(2) + 10*y(3) + 3*y(5)) + y(2)*(5*y(1) + 2*y(3) + 11*y(4) + 12*y(5)) + y(5)*(10*y(1) + 10*y(2) + 10*y(3) + 4*y(4)))
    %         ]; 
    %  
    %         dydt = [ -(y(1)*(y(1)*y(2) - a*y(4) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4)))/(y(1)*y(2) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4))
    %                  -(y(2)*(y(1)*y(2) - y(1) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4)))/(y(1)*y(2) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4))
    %                  -(y(3)*(y(1)*y(2) - y(2) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4)))/(y(1)*y(2) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4))
    %                  -(y(4)*(y(1)*y(2) - y(3) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4)))/(y(1)*y(2) + y(2)*y(3) + y(3)*y(4) + a*y(1)*y(4))];
    %   
        end
end


%% III. Solving systems of first-order ODEs
% function [T,Y] = call_osc()
% tspan = [0 30000];
% y1_0 = 2;
% y2_0 = 0;
% [T,Y] = ode15s(@osc,tspan,[y1_0 y2_0]);
% plot(T,Y(:,1),'o')
% 
%     function dydt = osc(t,y)
%     dydt = [y(2)
%            1000*(1 - y(1)^2)*y(2) - y(1)];
%     %Still y(1) is y1 and y(2) is y2, and dydt(1)
%     %is dy1/dt and dydt(2) is dy2/dt.
%     end
% 
% end
% 

%% II. Solving first-order ODEs
% function [t,y] = call_dstate()
% % https://web.mit.edu/voigtlab/BP205/Notes/BP205_Matlab_slides.pdf
%     tspan = [0 9]; % set time interval
%     y0 = 10; % set initial condition
%     % dstate evaluates r.h.s. of the ode
%     [t,y] = ode45( @dstate ,tspan ,y0);
%     plot(t,y)
%     disp([t,y]) % displays t and y(t)
%             function dydt = dstate (t,y)
%             alpha = 2; gamm a= 0.0001;
%             dydt = alpha* y - gamma *y^2;
%             end
% end